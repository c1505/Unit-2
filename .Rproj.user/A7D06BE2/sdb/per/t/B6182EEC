{
    "contents" : "climate = read.csv(\"climate_change.csv\")\n#moneyball = subset(baseball, Year < 2002)\nclimate_training = subset(climate, Year < 2007)\nclimate_test = subset(climate, Year > 2006)\nmodel1 = lm(Temp ~ MEI + CO2 + CH4 + N2O + CFC.11 + CFC.12 + \n              TSI + Aerosols, data = climate_training )\nsummary(model1)\ncor(climate_training)\nmodel2 = step(model1)\nsummary(model2)\nsummary(model1)\n#step fuction does not address colinearity\n#PointsPredictions = predict(PointsReg4, newdata=NBA_test)\nClimatePred = predict(model2, newdata=climate_test)\nClimatePred\n\n#SSE = sum((PointsPredictions - NBA_test$PTS)^2)\n#SST = sum((mean(NBA$PTS) - NBA_test$PTS)^2)\n#R2 = 1 - SSE/SST\nSSE = sum((ClimatePred - climate_test$Temp)^2)\nSST = sum((mean(climate_training$Temp) - climate_test$Temp)^2)\nR2 = 1 - SSE/SST\nR2\n\n\n#Part 2. reading test scores\n\npisaTrain = read.csv(\"pisa2009train.csv\")\npisaTest = read.csv(\"pisa2009test.csv\")\n\nstr(pisaTrain)\nmalestraining = subset(pisaTrain, male == 1)\nstr(malestraining)\n#sort(tapply((CPS$Race == \"Asian\"), CPS$MetroArea, mean))\nfemalestraining = subset(pisaTrain, male == 0)\nmean(femalestraining$readingScore)\nmean(malestraining$readingScore)\ntapply(pisaTrain$readingScore, pisaTrain$male, mean)\n\nstr(pisaTrain)\nsummary(pisaTrain)\n#remove na values \npisaTrain = na.omit(pisaTrain)\npisaTest=na.omit(pisaTest)\nstr(pisaTrain)\nstr(pisaTest)\ntable(pisaTrain$raceeth)\n\n#setting the reference level of the factor\npisaTrain$raceeth = relevel(pisaTrain$raceeth,\"White\")\npisaTest$raceeth = relevel(pisaTest$raceeth, \"White\")\nImScore = lm(readingScore ~ ., data = pisaTrain)\nsummary(ImScore)\n\n#PointsReg$residuals\n#SSE = sum(PointsReg$residuals^2)\n#SSE\n\n# Root mean squared error\n#RMSE = sqrt(SSE/nrow(NBA))\n#RMSE\nSSE = sum(ImScore$residuals^2)\nRMSE = sqrt(SSE/nrow(pisaTrain))\nRMSE\nImScoregrade = lm(readingScore ~ grade, data = pisaTrain)\nsummary(ImScoregrade)\nplot(pisaTrain$readingScore, pisaTrain$grade)\nmean(pisaTrain$readingScore)\nsummary(ImScore)\n\n#predict \n#ClimatePred = predict(model2, newdata=climate_test)\npredTest = predict(ImScore, newdata=pisaTest)\nsummary(predTest)\n353.2 - 637.7\n\n# Compute out-of-sample R^2\n#SSE = sum((PointsPredictions - NBA_test$PTS)^2) test data and predict result\n#SST = sum((mean(NBA$PTS) - NBA_test$PTS)^2)\n#R2 = 1 - SSE/SST\n\n\n# Compute the RMSE\n#RMSE = sqrt(SSE/nrow(NBA_test))\nSSE = sum((predTest - pisaTest$readingScore)^2)\nSSE\nRMSE = sqrt(SSE/nrow(pisaTest))\nRMSE\nmean(pisaTest$readingScore)\nSST = sum((mean(pisaTest$readingScore) - pisaTest$readingScore)^2)\nSST\nR2 = 1-SSE/SST\nR2\n\n#part 3 flu\nFluTrain = read.csv(\"FluTrain.csv\")\nmax(FluTrain$ILI)\nwhich.max(FluTrain$ILI)\nFluTrain$Week[which.max(FluTrain$ILI)]\nhist(FluTrain$ILI)\nplot(log(FluTrain$ILI), FluTrain$Queries)\nplot(FluTrain$ILI, FluTrain$Queries)\nFluTrend1 = lm(log(ILI) ~ Queries, data=FluTrain)\nsummary(FluTrend1)\ncor(log(FluTrain$ILI), FluTrain$Queries)\n\nFluTest = read.csv(\"FluTest.csv\")\npredTest1=exp(predict(FluTrend1,newdata=FluTest))\nsummary(predTest1)\nFluTest$Week\n0.49934 + 0.4329349*2.96129\n#still don't understand problem 3.1 \n(2.2934216-2.187383)/2.2934216\n#SSE = sum((predTest - pisaTest$readingScore)^2)\nSSE = sum((predTest1 - FluTest$ILI)^2)\nRMSE = sqrt(SSE/nrow(FluTest))\nRMSE\n#installing and using packages\ninstall.packages(\"zoo\")\nlibrary(zoo)\nILILag2 = lag(zoo(FluTrain$ILI), -2, na.pad=TRUE)\nFluTrain$ILILag2 = coredata(ILILag2)\nsummary(ILILag2)\nplot(log(ILILag2), log(FluTrain$ILI))\nFluTrend2 = lm(log(ILI) ~ Queries + log(ILILag2), data=FluTrain)\nsummary(FluTrend2)\nILILag2 = lag(zoo(FluTest$ILI), -2, na.pad=TRUE)\nFluTest$ILILag2 = coredata(ILILag2)\nsummary(FluTest)\nFluTest$ILILag2[1]=FluTrain$ILI[416]\nFluTest$ILILag2[2]=FluTrain$ILI[417]\npredTest2=exp(predict(FluTrend2,newdata=FluTest))\nSSE = sum((predTest2 - FluTest$ILI)^2)\nRMSE = sqrt(SSE/nrow(FluTest))\nRMSE\n",
    "created" : 1427155169834.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "348047752",
    "id" : "B6182EEC",
    "lastKnownWriteTime" : 1427173525,
    "path" : "C:/Users/Corey/OneDrive/Documents/Analytics Edge/Unit 2/homework 2.R",
    "project_path" : "homework 2.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}